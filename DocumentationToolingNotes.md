# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="a997d-101">Como a documentação da API JavaScript do Office é gerada</span><span class="sxs-lookup"><span data-stu-id="a997d-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="a997d-102">As páginas de documentação de referência do JavaScript para Office são geradas a partir de arquivos de definição de tipo e trechos de exemplo.</span><span class="sxs-lookup"><span data-stu-id="a997d-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="a997d-103">Esse processo usa uma mistura de ferramentas de código aberto e scripts específicos do repositório.</span><span class="sxs-lookup"><span data-stu-id="a997d-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="a997d-104">Este documento tem como objetivo tornar os processos deste repositório transparentes para que a comunidade possa se beneficiar melhor e contribuir com esse conteúdo.</span><span class="sxs-lookup"><span data-stu-id="a997d-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="a997d-105">Fontes de conteúdo</span><span class="sxs-lookup"><span data-stu-id="a997d-105">Content sources</span></span>

<span data-ttu-id="a997d-106">Dois tipos de conteúdo são combinados para criar a documentação de referência do Office-JS: definições de tipo e trechos de código.</span><span class="sxs-lookup"><span data-stu-id="a997d-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="a997d-107">Eles garantem uma cobertura completa da API e dão pequenos exemplos de código em linha.</span><span class="sxs-lookup"><span data-stu-id="a997d-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="a997d-108">Arquivos de definição de tipo</span><span class="sxs-lookup"><span data-stu-id="a997d-108">Type definition files</span></span>

<span data-ttu-id="a997d-109">Os arquivos de definição de tipo [em Definitivamente Digitados](https://github.com/DefinitelyTyped/DefinitelyTyped) são a única fonte da verdade para a documentação.</span><span class="sxs-lookup"><span data-stu-id="a997d-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="a997d-110">Qualquer Complemento do Office que usa TypeScript compila usando esses arquivos de definição de tipo.</span><span class="sxs-lookup"><span data-stu-id="a997d-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="a997d-111">Eles também dão recursos do IntelliSense para desenvolvedores de JavaScript e TypeScript.</span><span class="sxs-lookup"><span data-stu-id="a997d-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="a997d-112">Ao criar a documentação de referência a partir dessas definições, fornecemos informações mais precisas.</span><span class="sxs-lookup"><span data-stu-id="a997d-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="a997d-113">Há quatro arquivos d.ts relevantes que fornecem conteúdo de origem para diferentes subseções dos documentos.</span><span class="sxs-lookup"><span data-stu-id="a997d-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="a997d-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (As definições de versão.)</span><span class="sxs-lookup"><span data-stu-id="a997d-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="a997d-115">Excel (Versão)</span><span class="sxs-lookup"><span data-stu-id="a997d-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="a997d-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="a997d-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="a997d-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="a997d-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="a997d-118">Visio</span><span class="sxs-lookup"><span data-stu-id="a997d-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="a997d-119">Word (Versão)</span><span class="sxs-lookup"><span data-stu-id="a997d-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="a997d-120">Subseção OfficeExtensions da API comum</span><span class="sxs-lookup"><span data-stu-id="a997d-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="a997d-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (As definições de visualização.)</span><span class="sxs-lookup"><span data-stu-id="a997d-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="a997d-122">Excel (Visualização)</span><span class="sxs-lookup"><span data-stu-id="a997d-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="a997d-123">Outlook (Visualização)</span><span class="sxs-lookup"><span data-stu-id="a997d-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="a997d-124">Word (Visualização)</span><span class="sxs-lookup"><span data-stu-id="a997d-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="a997d-125">API Comum</span><span class="sxs-lookup"><span data-stu-id="a997d-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="a997d-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (as definições de tempo de execução de Funções Personalizadas do Excel.)</span><span class="sxs-lookup"><span data-stu-id="a997d-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="a997d-127">Funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="a997d-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="a997d-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (As definições de tempo de execução do office para a plataforma de funções personalizadas.)</span><span class="sxs-lookup"><span data-stu-id="a997d-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="a997d-129">Office Runtime</span><span class="sxs-lookup"><span data-stu-id="a997d-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="a997d-130">As versões mais antigas das APIs têm seus próprios arquivos d.ts.</span><span class="sxs-lookup"><span data-stu-id="a997d-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="a997d-131">Eles são preservados quando um novo conjunto de requisitos de API é lançado.</span><span class="sxs-lookup"><span data-stu-id="a997d-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="a997d-132">Eles também podem ser gerados usando a ferramenta [Remover Versão.](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)</span><span class="sxs-lookup"><span data-stu-id="a997d-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="a997d-133">Esses arquivos d.ts antigos são mantidos para que, nas APIs de evento sejam corrigidas ou alteradas, o comportamento original ainda esteja documentado.</span><span class="sxs-lookup"><span data-stu-id="a997d-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="a997d-134">Isso será útil se você tiver que direcionar uma versão mais antiga da API.</span><span class="sxs-lookup"><span data-stu-id="a997d-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="a997d-135">Teste de alterações de arquivo de definição de tipo</span><span class="sxs-lookup"><span data-stu-id="a997d-135">Testing type definition file changes</span></span>

<span data-ttu-id="a997d-136">Qualquer alteração de documentação para a API JavaScript do Office é feita editando os quatro arquivos d.ts mencionados acima.</span><span class="sxs-lookup"><span data-stu-id="a997d-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="a997d-137">No entanto, você pode testar uma alteração antes de enviar um PR para DefinitelyTyped (se precisar, por exemplo, testar como sua formatação será traduzida para markdown) editando o arquivo correspondente em [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) e executando [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span><span class="sxs-lookup"><span data-stu-id="a997d-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="a997d-138">Quando solicitado, selecione a opção "Arquivos locais".</span><span class="sxs-lookup"><span data-stu-id="a997d-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="a997d-139">Fazer alterações em um branch remoto desse repo faz com que a plataforma docs.microsoft.com crie uma ramificação de teste.</span><span class="sxs-lookup"><span data-stu-id="a997d-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="a997d-140">Essa ramificação é renderizada review.docs.microsoft.com, que só pode ser acessada pela equipe interna da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a997d-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="a997d-141">Qualquer pessoa que analisar seu PR verificará a precisão do site de revisão.</span><span class="sxs-lookup"><span data-stu-id="a997d-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="a997d-142">Trechos de código</span><span class="sxs-lookup"><span data-stu-id="a997d-142">Code snippets</span></span>

<span data-ttu-id="a997d-143">Trechos de código de exemplo são adicionados às páginas de referência de duas fontes:</span><span class="sxs-lookup"><span data-stu-id="a997d-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="a997d-144">Amostras do Script Lab</span><span class="sxs-lookup"><span data-stu-id="a997d-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="a997d-145">Trechos de Código Local</span><span class="sxs-lookup"><span data-stu-id="a997d-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="a997d-146">Os trechos de código locais estão em arquivos yaml específicos do host.</span><span class="sxs-lookup"><span data-stu-id="a997d-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="a997d-147">Seu conteúdo é organizado por classe e campo, para que possa ser mapeado para o local apropriado em uma página de referência.</span><span class="sxs-lookup"><span data-stu-id="a997d-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="a997d-148">A linguagem do trecho de código (JavaScript ou TypeScript) é inferida pelo uso de instruções de espera.</span><span class="sxs-lookup"><span data-stu-id="a997d-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="a997d-149">Os trechos de código do Script Lab são retirados de amostras de trabalho.</span><span class="sxs-lookup"><span data-stu-id="a997d-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="a997d-150">Atualmente, exemplos do Excel, Outlook, PowerPoint e Word são mapeados para seções de documento de referência por meio de [arquivos de mapeamento.](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata)</span><span class="sxs-lookup"><span data-stu-id="a997d-150">Currently, Excel, Outlook, PowerPoint, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata).</span></span> <span data-ttu-id="a997d-151">Eles combinam métodos de exemplo individuais com propriedades ou métodos na API.</span><span class="sxs-lookup"><span data-stu-id="a997d-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="a997d-152">Quando o repositório office-js-snippets é executado, um arquivo yaml que contém todos os `yarn start` trechos mapeados é criado. [](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml)</span><span class="sxs-lookup"><span data-stu-id="a997d-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="a997d-153">Esse arquivo yaml é a entrada na ferramenta de documentação de referência.</span><span class="sxs-lookup"><span data-stu-id="a997d-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="a997d-154">Pipeline de ferramentas</span><span class="sxs-lookup"><span data-stu-id="a997d-154">Tooling pipeline</span></span>

![Uma imagem mostrando o fluxo de controle de Definitivamente Digitado, para o pré-processador, o Extrator de API, o processador médio, o Documentador de API e até o pós-processador.](ToolingPipeline.png)

<span data-ttu-id="a997d-156">Entre as fontes de conteúdo e as páginas finais, o conteúdo da documentação passa por cinco etapas de ferramentas:</span><span class="sxs-lookup"><span data-stu-id="a997d-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="a997d-157">Script de pré-processador</span><span class="sxs-lookup"><span data-stu-id="a997d-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="a997d-158">Extrator de API</span><span class="sxs-lookup"><span data-stu-id="a997d-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="a997d-159">Script Midprocessor</span><span class="sxs-lookup"><span data-stu-id="a997d-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="a997d-160">Documentador de API</span><span class="sxs-lookup"><span data-stu-id="a997d-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="a997d-161">Script postprocessor</span><span class="sxs-lookup"><span data-stu-id="a997d-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="a997d-162">O pré-processador pega os arquivos d.ts e os divide em seções específicas do host.</span><span class="sxs-lookup"><span data-stu-id="a997d-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="a997d-163">Ele executa qualquer limpeza necessária para que as ferramentas subsequentes processem corretamente os dados.</span><span class="sxs-lookup"><span data-stu-id="a997d-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="a997d-164">O Extrator de API converte os arquivos d.ts em dados JSON.</span><span class="sxs-lookup"><span data-stu-id="a997d-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="a997d-165">Isso tokeniza todos os dados do tipo, permitindo uma análise mais fácil.</span><span class="sxs-lookup"><span data-stu-id="a997d-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="a997d-166">O processador médio recupera os trechos de código, os emparelha com os hosts apropriados e limpa o crosslink entre objetos do Outlook e da API comum.</span><span class="sxs-lookup"><span data-stu-id="a997d-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="a997d-167">O Documentador de API converte os dados JSON em arquivos .yml.</span><span class="sxs-lookup"><span data-stu-id="a997d-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="a997d-168">Os arquivos .yml são convertidos em markdown pelo Open Publishing System que publica nossos documentos no docs.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="a997d-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="a997d-169">O Documentador de API também contém uma extensão específica do Office que insere nossos trechos de código.</span><span class="sxs-lookup"><span data-stu-id="a997d-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="a997d-170">O pós-processador limpa o índice e move os arquivos .yml para a [pasta de publicação.](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen)</span><span class="sxs-lookup"><span data-stu-id="a997d-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="a997d-171">Todas essas cinco etapas são executadas [quando GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) é executado.</span><span class="sxs-lookup"><span data-stu-id="a997d-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="a997d-172">Esse script também lida com a instalação do módulo de nó, limpa conjuntos de arquivos antigos e versões dos arquivos de Definição de Tipo para cada conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="a997d-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
